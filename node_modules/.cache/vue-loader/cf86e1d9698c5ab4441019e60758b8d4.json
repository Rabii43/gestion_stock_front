{"remainingRequest":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/terres-rabii/Documents/travail/scrum/gestion stock front/src/router/views/users/users-details/index.vue?vue&type=style&index=0&id=942a7baa&scoped=true&lang=css&","dependencies":[{"path":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/src/router/views/users/users-details/index.vue","mtime":1652332860805},{"path":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/node_modules/css-loader/dist/cjs.js","mtime":1647982857669},{"path":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1648047806763},{"path":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/node_modules/postcss-loader/src/index.js","mtime":1647982858082},{"path":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/node_modules/cache-loader/dist/cjs.js","mtime":1647982849025},{"path":"/home/terres-rabii/Documents/travail/scrum/gestion stock front/node_modules/vue-loader/lib/index.js","mtime":1648047806763}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKdGggewogIHdpZHRoOiAzMCUgIWltcG9ydGFudDsKfQoKLmZpbGUtaW5wdXQgewogIGRpc3BsYXk6IG5vbmU7Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuXA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/router/views/users/users-details","sourcesContent":["<template>\n  <Layout>\n    <PageHeader :title=\"title\" :items=\"items\"/>\n    <div class=\"card\" v-if=\"usersData\">\n      <div class=\"card-body px-4 py-1\">\n        <div class=\"row\">\n          <div class=\"col-sm-1\">\n            <div v-if=\"!usersData.image\" class=\"avatar-sm\">\n              <span class=\"avatar-title rounded-circle\">{{ userFirstChar(usersData) }}</span>\n            </div>\n            <div class=\"avatar-sm mt-2\" v-if=\"usersData.image\">\n              <img\n                  :src=\"pathImage(usersData.image)\"\n                  alt=\"user image\"\n                  width=\"70px\"\n                  height=\"60px\"\n                  class=\"rounded-circle header-profile-user\"\n              />\n            </div>\n          </div>\n          <div class=\"col-sm-5\">\n            <b-button\n                variant=\"light\"\n                v-if=\"toEditProfile\"\n                class=\"mt-2 btn-block\"\n                @click=\"chooseImage\"\n            >\n              <i class=\"bx bx-camera font-size-16 align-middle me-2\"></i>\n              Modifier l'image\n            </b-button>\n            <input\n                @change=\"selectedFile($event)\"\n                class=\"form-control file-input\"\n                type=\"file\"\n                ref=\"fileInput\"\n                id=\"formFile\"\n            />\n            <h5 class=\"card-title mt-4\" v-if=\"!toEditProfile && !Loading\">\n              {{ (usersData.firstname) ? usersData.firstname.toUpperCase() : \"\" }}\n              {{ (usersData.lastname) ? usersData.lastname.toUpperCase() : \"\" }}\n            </h5>\n            <b-spinner v-else-if=\"Loading\" variant=\"success\" class=\"mt-3\" small></b-spinner>\n          </div>\n          <div class=\"col-sm-6\">\n            <div class=\"py-2 text-end\">\n              <b-button\n                  variant=\"light\"\n                  class=\"btn-block mx-2\"\n                  @click=\"showModal = true\"\n              >\n                Modifier le mot de passe\n              </b-button>\n              <a\n                  href=\"#\"\n                  class=\"btn btn-md ml-2\"\n                  :class=\"toEditProfile ? 'btn-outline-secondary' : 'btn-primary'\"\n                  @click=\"toEditProfile = !toEditProfile\"\n              >\n                <i v-if=\"toEditProfile\" class=\"fas fa-arrow-left\"></i>\n                {{ toEditProfile ? \"Retour\" : \"Modifier\" }}\n                <i v-if=\"!toEditProfile\" class=\"fas fa-pen\"></i>\n              </a>\n            </div>\n            <b-modal title=\"Mot de passe\" v-model=\"showModal\" hide-footer>\n              <b-form class=\"p-2\" @submit.prevent=\"tryToUpdatePassword\">\n                <b-form-group\n                    class=\"mb-3\"\n                    id=\"password-group\"\n                    label=\"Ancien mot de passe\"\n                    label-for=\"password\"\n                >\n                  <b-form-input\n                      id=\"password\"\n                      v-model=\"updatePass.oldPassword\"\n                      type=\"password\"\n                  ></b-form-input>\n                </b-form-group>\n                <b-form-group\n                    class=\"mb-3\"\n                    id=\"password-group\"\n                    label=\"Nouveau mot de passe\"\n                    label-for=\"new\"\n                >\n                  <b-form-input\n                      id=\"new\"\n                      v-model=\"updatePass.newPassword\"\n                      type=\"password\"\n                  ></b-form-input>\n                </b-form-group>\n                <div class=\"mt-4 mb-4 d-flex justify-content-end\">\n                  <div class=\"p-2\">\n                    <b-button\n                        type=\"submit\"\n                        variant=\"magenta\"\n                        class=\"btn-block py-2 px-4 ml-4\"\n                    >valider\n                    </b-button>\n                  </div>\n                </div>\n              </b-form>\n            </b-modal>\n          </div>\n        </div>\n      </div>\n    </div>\n    <b-alert\n        v-model=\"updatePassSuccess\"\n        class=\"mt-3\"\n        variant=\"success\"\n        dismissible\n    >Mot de passe mis à jour avec succès\n    </b-alert>\n    <b-alert\n        v-model=\"updatePassError\"\n        class=\"mt-3\"\n        variant=\"danger\"\n        dismissible\n    >Le mot de passe actuel est incorrect! essayer à nouveau\n    </b-alert>\n    <b-alert\n        v-model=\"registerSuccess\"\n        class=\"mt-3\"\n        variant=\"success\"\n        dismissible\n    >Votre profil a été mis à jour avec succès\n    </b-alert>\n    <div v-if=\"!toEditProfile\" class=\"card\">\n      <div class=\"card-body\">\n        <div class=\"table-responsive px-2\">\n          <table class=\"table table-nowrap\">\n            <h5 class=\"card-title py-2\">Infromation générale:</h5>\n            <tbody>\n            <tr>\n              <th scope=\"row\">Nom et prénom:</th>\n              <td v-if=\"usersData.firstname || usersData.lastname\">{{ usersData.firstname }}\n                {{ usersData.lastname }}\n              </td>\n              <td v-else-if=\"Loading\">\n                <b-spinner variant=\"success\" small></b-spinner>\n              </td>\n              <td v-else class=\"text-muted-color\">Aucune données</td>\n            </tr>\n            <tr>\n              <th scope=\"row\">E-mail :</th>\n              <td v-if=\"usersData.email\">{{ usersData.email }}</td>\n              <td v-else-if=\"Loading\">\n                <b-spinner variant=\"success\" small></b-spinner>\n              </td>\n              <td v-else class=\"text-muted-color\">Aucune données</td>\n            </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n    <div v-if=\"toEditProfile\" class=\"card overflow-hidden\">\n      <div class=\"card-body pt-0\">\n        <b-alert\n            v-model=\"isRegisterError\"\n            class=\"mt-3\"\n            variant=\"danger\"\n        >{{ regError }}\n        </b-alert>\n        <b-form class=\"p-2\">\n          <b-form-group class=\"mb-3\" id=\"firstname\" label=\"Nom\" label-for=\"nom\">\n            <b-form-input\n                id=\"firstname\"\n                v-model=\"user.firstName\"\n                type=\"text\"\n                placeholder=\"Entrer votre nom\"\n                :class=\"{\n                'is-invalid': submitted && $v.user.firstName.$error,\n              }\"\n            ></b-form-input>\n            <div\n                v-if=\"submitted && !$v.user.firstName.required\"\n                class=\"invalid-feedback\"\n            >\n              Nom est requis.\n            </div>\n          </b-form-group>\n          <b-form-group\n              class=\"mb-3\"\n              id=\"lastname\"\n              label=\"Prénom\"\n              label-for=\"prenom\"\n          >\n            <b-form-input\n                id=\"lastname\"\n                v-model=\"user.lastName\"\n                type=\"text\"\n                placeholder=\"Entrer votre prénom\"\n                :class=\"{\n                'is-invalid': submitted && $v.user.lastName.$error,\n              }\"\n            ></b-form-input>\n            <div\n                v-if=\"submitted && !$v.user.lastName.required\"\n                class=\"invalid-feedback\"\n            >\n              Prénom est requis.\n            </div>\n          </b-form-group>\n          <div class=\"mt-4 mb-4 text-end\">\n            <b-button type=\"submit\" variant=\"magenta\" class=\"btn-md\" @click=\"tryToModify($event)\"\n            >Enregistrer\n            </b-button>\n          </div>\n        </b-form>\n      </div>\n    </div>\n  </Layout>\n</template>\n<script>\nimport Layout from \"../../../layouts/main\";\nimport appConfig from \"@/app.config.json\";\nimport PageHeader from \"@/components/page-header\";\nimport {email, required} from \"vuelidate/lib/validators\";\nimport {updatePassword, usersDetails} from \"../../../../../api/entryPoint\";\nimport axios from \"axios\";\n\n/**\n * Users Details Component\n */\nexport default {\n  page: {\n    title: \"Mon profil\",\n    meta: [\n      {\n        name: \"description\",\n        content: appConfig.description,\n      },\n    ],\n  },\n  components: {\n    Layout,\n    PageHeader,\n  },\n  data() {\n    return {\n      title: \"Mon profil\",\n      items: [],\n      baseURL: process.env.API_URL,\n      toEditProfile: false,\n      user: {\n        email: \"\",\n        firstName: \"\",\n        lastName: \"\",\n      },\n      updatePass: {\n        oldPassword: \"\",\n        newPassword: \"\",\n      },\n      submitted: false,\n      regError: null,\n      isRegisterError: false,\n      registerSuccess: false,\n      showModal: false,\n      updatePassSuccess: false,\n      updatePassError: false,\n      file: null,\n    };\n  },\n  validations: {\n    user: {\n      firstName: {\n        required,\n      },\n      lastName: {\n        required,\n      },\n      email: {\n        required,\n        email,\n      },\n    },\n  },\n  created() {\n    // Call users details method\n    this.getUsersDetails();\n  },\n  methods: {\n    // Get Users Details\n    getUsersDetails() {\n      this.$store.dispatch(\"users/usersDetails\", this.$route.params.id);\n    },\n    // Set an absolute path for image\n    pathImage(name) {\n      return this.baseURL + \"/uploads/images/\" + name;\n    },\n    // Update User\n    tryToModify(event) {\n      event.preventDefault();\n      this.submitted = true;\n      this.$v.$touch();\n      // if (!this.$v.$invalid && this.ValidatePhoneNumber(this.user.phone)) {\n      //   let data;\n      //   // If we have an image to upload we use a formData else we use json\n      //   data = new FormData();\n      //   for (let key in this.user) {\n      //     data.append(key, this.user[key]);\n      //   }\n      //   data.append(\"image\", this.file);\n      //   // Send user data\n      //   axios.post(usersDetails + this.$route.params.id, data\n      //   ).then((res) => {\n      //     if (res.data.code === 200) {\n      //       this.registerSuccess = true;\n      //       // refresh user details\n      //       this.getUsersDetails();\n      //       this.getUsersDetailsNav();\n      //       this.toEditProfile = false;\n      //     } else {\n      //       this.isRegisterError = true;\n      //       this.regError = \"échec de la modification de l'utilisateur\";\n      //     }\n      //   }).catch((error) => {\n      //     this.isRegisterError = true;\n      //     this.regError = \"échec de la modification de l'utilisateur\";\n      //   });\n      // } else {\n      //   return;\n      // }\n    },\n    // fill inputs with user data\n    matchUserData(res) {\n      this.user.firstName = res.firstName;\n      this.user.lastName = res.lastName;\n      this.user.email = res.email;\n    },\n    // Update user Password\n    tryToUpdatePassword() {\n      axios.post(updatePassword + this.$route.params.id,\n          this.updatePass\n      ).then((res) => {\n        if (res.status === 200) {\n          this.updatePassSuccess = true;\n        }\n      }).catch((error) => {\n        this.updatePassError = true;\n      });\n      this.showModal = false;\n      this.updatePass = {};\n    },\n    // choose Image Profile\n    chooseImage() {\n      this.$refs.fileInput.click();\n    },\n    // Select file\n    selectedFile(e) {\n      this.file = e.target.files[0];\n    },\n    // First char from username\n    userFirstChar(data) {\n      return data.username ? data.username.charAt(0).toUpperCase() : \"\";\n    },\n  },\n  computed: {\n    // get user data from store\n    usersData() {\n      let res = this.$store.getters[\"users/getUsersDetails\"];\n      if (res) {\n        this.matchUserData(res);\n      }\n      return res;\n    },\n    Loading() {\n      return this.$store.getters[\"users/getIsLoading\"];\n    },\n  },\n};\n</script>\n\n\n<style scoped>\nth {\n  width: 30% !important;\n}\n\n.file-input {\n  display: none;\n}\n</style>"]}]}